"""
Workspace management
"""
enum WorkspaceColor {
	ROSE
	PEACH
	AMBER
	MINT
	SKY
}

enum WorkspaceMemberRole {
	OWNER
	ADMIN
	EDITOR
	VIEWER
}

enum AnalysisModelTier {
	LIGHTWEIGHT
	MEDIUM
	HEAVY
}

enum AiModelTask {
	EMBEDDING
	OCR
	OBJECT_DETECTION
}

type Workspace {
	id: ID!
	name: String!
	color: WorkspaceColor!
	ownerId: ID!
	syncOperationsToProvider: Boolean!
	createdAt: DateTime!
	updatedAt: DateTime!
}

type WorkspaceMember {
	userId: ID!
	name: String!
	email: String!
	role: WorkspaceMemberRole!
	joinedAt: DateTime!
	isOwner: Boolean!
}

type WorkspaceInvite {
	id: ID!
	token: String!
	role: WorkspaceMemberRole!
	expiresAt: DateTime!
	createdAt: DateTime!
}

type WorkspaceStatsBucket {
	bucketStart: DateTime!
	uploadedBytes: Float!
	downloadedBytes: Float!
	bandwidthBytes: Float!
}

type WorkspaceStats {
	workspaceId: ID!
	days: Int!
	totalFiles: Float!
	totalSizeBytes: Float!
	totalProviders: Float!
	uploadedBytes: Float!
	downloadedBytes: Float!
	bandwidthBytes: Float!
	buckets: [WorkspaceStatsBucket!]!
}

type WorkspaceAiSettings {
	workspaceId: ID!
	enabled: Boolean!
	modelsReady: Boolean!
	embeddingTier: AnalysisModelTier!
	ocrTier: AnalysisModelTier!
	objectTier: AnalysisModelTier!
	maxConcurrency: Int!
	config: JSON!
	updatedAt: DateTime!
}

type WorkspaceAiProgress {
	workspaceId: ID!
	eligibleFiles: Int!
	processedFiles: Int!
	pendingFiles: Int!
	runningFiles: Int!
	failedFiles: Int!
	skippedFiles: Int!
	completedFiles: Int!
	completionPct: Float!
	updatedAt: DateTime!
}

extend type Query {
	"""
	Get current user's workspaces
	"""
	workspaces: [Workspace!]!

	"""
	List members for a workspace
	"""
	workspaceMembers(workspaceId: ID!): [WorkspaceMember!]!

	"""
	List active invites for a workspace
	"""
	workspaceInvites(workspaceId: ID!): [WorkspaceInvite!]!

	"""
	Get workspace storage and bandwidth stats
	"""
	workspaceStats(workspaceId: ID!, days: Int = 30): WorkspaceStats!

	"""
	Get workspace AI settings
	"""
	workspaceAiSettings(workspaceId: ID!): WorkspaceAiSettings!

	"""
	Get workspace AI processing progress
	"""
	workspaceAiProgress(workspaceId: ID!): WorkspaceAiProgress!
}

extend type Subscription {
	"""
	Subscribe to AI processing progress updates for a workspace
	"""
	workspaceAiProgressUpdated(workspaceId: ID!): WorkspaceAiProgress!
}

input CreateWorkspaceInput {
	name: String!
	color: WorkspaceColor!
}

input CreateWorkspaceInviteInput {
	workspaceId: ID!
	role: WorkspaceMemberRole!
	expiresInDays: Int = 7
}

input UpdateWorkspaceMemberRoleInput {
	workspaceId: ID!
	userId: ID!
	role: WorkspaceMemberRole!
}

input UpdateWorkspaceNameInput {
	workspaceId: ID!
	name: String!
}

input UpdateWorkspaceSyncOperationsInput {
	workspaceId: ID!
	enabled: Boolean!
}

input UpdateWorkspaceAiSettingsInput {
	workspaceId: ID!
	enabled: Boolean
	embeddingTier: AnalysisModelTier
	ocrTier: AnalysisModelTier
	objectTier: AnalysisModelTier
	maxConcurrency: Int
	config: JSON
}

extend type Mutation {
	"""
	Create a new workspace
	"""
	createWorkspace(input: CreateWorkspaceInput!): Workspace!

	"""
	Create workspace invite link with role
	"""
	createWorkspaceInvite(input: CreateWorkspaceInviteInput!): WorkspaceInvite!

	"""
	Accept workspace invite link
	"""
	acceptWorkspaceInvite(token: String!): Workspace!

	"""
	Update workspace member role
	"""
	updateWorkspaceMemberRole(input: UpdateWorkspaceMemberRoleInput!): Boolean!

	"""
	Update workspace name
	"""
	updateWorkspaceName(input: UpdateWorkspaceNameInput!): Workspace!

	"""
	Update workspace sync behavior for move/rename operations
	"""
	updateWorkspaceSyncOperations(
		input: UpdateWorkspaceSyncOperationsInput!
	): Workspace!

	"""
	Update workspace AI settings
	"""
	updateWorkspaceAiSettings(
		input: UpdateWorkspaceAiSettingsInput!
	): WorkspaceAiSettings!

	"""
	Download/prepare AI models for current workspace settings
	"""
	prepareWorkspaceAiModels(
		workspaceId: ID!
		tasks: [AiModelTask!]
	): Boolean!

	"""
	Enable AI processing and enqueue workspace backfill analysis
	"""
	startWorkspaceAiProcessing(workspaceId: ID!): Boolean!

	"""
	Stop AI processing and cancel queued analysis jobs
	"""
	stopWorkspaceAiProcessing(workspaceId: ID!): Boolean!

	"""
	Delete all AI analysis data for the workspace
	"""
	deleteWorkspaceAiData(workspaceId: ID!): Boolean!

	"""
	Retry AI processing for files whose latest run failed
	"""
	retryWorkspaceAiFailedFiles(workspaceId: ID!): Boolean!

	"""
	Remove a member from workspace
	"""
	removeWorkspaceMember(workspaceId: ID!, userId: ID!): Boolean!

	"""
	Revoke a workspace invite link
	"""
	revokeWorkspaceInvite(workspaceId: ID!, inviteId: ID!): Boolean!
}
