"""
A registered passkey credential
"""
type Passkey {
	id: ID!
	name: String!
	deviceType: String!
	backedUp: Boolean!
	createdAt: String!
	lastUsedAt: String
}

"""
Authentication and authorization
"""
type Query {
	"""
	Get current authenticated user
	"""
	me: User

	"""
	List passkeys registered for the current user
	"""
	myPasskeys: [Passkey!]!
}

type Mutation {
	"""
	Register a new user (only owner can register new users)
	"""
	register(input: RegisterInput!): AuthResponse!

	"""
	Login with email and password
	"""
	login(input: LoginInput!): AuthResponse!

	"""
	Logout current user
	"""
	logout: Boolean!

	"""
	Request password reset OTP
	"""
	requestPasswordReset(email: String!): Boolean!

	"""
	Reset password with OTP
	"""
	resetPassword(input: ResetPasswordInput!): Boolean!

	"""
	Change password (requires authentication)
	"""
	changePassword(input: ChangePasswordInput!): Boolean!

	"""
	Update current user's profile
	"""
	updateMyProfile(input: UpdateMyProfileInput!): User!

	"""
	Complete user onboarding
	"""
	completeOnboarding: Boolean!

	"""
	Start passkey registration (returns JSON options string)
	"""
	startPasskeyRegistration: String!

	"""
	Verify passkey registration response and store credential
	"""
	verifyPasskeyRegistration(name: String!, response: String!): Passkey!

	"""
	Start passkey login â€” returns JSON with optionsJson and challengeId (no email needed)
	"""
	startPasskeyLogin: String!

	"""
	Verify passkey login response and return session
	"""
	verifyPasskeyLogin(challengeId: String!, response: String!): AuthResponse!

	"""
	Delete a registered passkey
	"""
	deletePasskey(id: ID!): Boolean!
}

input RegisterInput {
	email: String!
	password: String!
	role: UserRole!
}

input LoginInput {
	email: String!
	password: String!
}

input ResetPasswordInput {
	email: String!
	otp: String!
	newPassword: String!
}

input ChangePasswordInput {
	currentPassword: String!
	newPassword: String!
}

input UpdateMyProfileInput {
	name: String!
}

type AuthResponse {
	"""
	JWT access token
	"""
	token: String!

	"""
	Authenticated user
	"""
	user: User!
}
